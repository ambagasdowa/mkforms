<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Checkboxes</title>
  </head>
  <body>
    <canvas height="400" width="750">
      <label><input type="checkbox" id="showA" /> Show As</label>
      <label><input type="checkbox" id="showB" /> Show Bs</label>
      <!-- ... -->
    </canvas>

    <script>
      function drawCheckbox(context, element, x, y, paint) {
        context.save();
        context.font = "10px sans-serif";
        context.textAlign = "left";
        context.textBaseline = "middle";
        var metrics = context.measureText(element.labels[0].textContent);
        if (paint) {
          context.beginPath();
          context.strokeStyle = "blue";
          context.rect(x - 5, y - 5, 10, 10);
          context.stroke();
          if (element.checked) {
            context.fillStyle = "blue";
            context.fill();
          }
          context.fillText(element.labels[0].textContent, x + 5, y);
        }
        context.beginPath();
        context.rect(x - 7, y - 7, 12 + metrics.width + 2, 14);

        context.drawFocusIfNeeded(element);
        context.restore();
      }

      function drawBase() {
        /* ... */
      }
      function drawAs() {
        /* ... */
      }
      function drawBs() {
        /* ... */
      }
      function redraw() {
        var canvas = document.getElementsByTagName("canvas")[0];
        var context = canvas.getContext("2d");
        context.clearRect(0, 0, canvas.width, canvas.height);
        drawCheckbox(context, document.getElementById("showA"), 20, 40, true);
        drawCheckbox(context, document.getElementById("showB"), 20, 60, true);
        drawBase();
        if (document.getElementById("showA").checked) drawAs();
        if (document.getElementById("showB").checked) drawBs();
      }

      function processClick(event) {
        var canvas = document.getElementsByTagName("canvas")[0];
        var context = canvas.getContext("2d");
        var x = event.clientX;
        var y = event.clientY;
        var node = event.target;
        while (node) {
          x -= node.offsetLeft - node.scrollLeft;
          y -= node.offsetTop - node.scrollTop;
          node = node.offsetParent;
        }
        drawCheckbox(context, document.getElementById("showA"), 20, 40, false);
        if (context.isPointInPath(x, y))
          document.getElementById("showA").checked =
            !document.getElementById("showA").checked;
        drawCheckbox(context, document.getElementById("showB"), 20, 60, false);
        if (context.isPointInPath(x, y))
          document.getElementById("showB").checked =
            !document.getElementById("showB").checked;
        redraw();
      }
      document
        .getElementsByTagName("canvas")[0]
        .addEventListener("focus", redraw, true);
      document
        .getElementsByTagName("canvas")[0]
        .addEventListener("blur", redraw, true);
      document
        .getElementsByTagName("canvas")[0]
        .addEventListener("change", redraw, true);
      document
        .getElementsByTagName("canvas")[0]
        .addEventListener("click", processClick, false);
      redraw();
    </script>
  </body>
</html>
